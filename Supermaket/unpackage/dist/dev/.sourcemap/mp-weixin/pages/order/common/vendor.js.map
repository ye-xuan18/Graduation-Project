{"version":3,"sources":["uni-app:///api/after-sale.js","uni-app:///js_sdk/lili-pay/wx-pay.js"],"names":["getAfterSale","params","http","request","url","method","Method","GET","needToken","loading","applyCancelOrder","POST","getStoreAfterSaleAddress","sn","cancelAfterSale","afterSaleSn","getAfterSaleList","getServiceDetail","addComplain","header","data","clearComplain","id","PUT","getAfterSaleLog","getComplain","getAfterSaleReason","serviceType","getClearReason","getComplainReason","getComplainDetail","getAfterSaleInfo","applyReturn","orderItemSn","fillShipInfo","communication","LiLiWXPay","payList","console","log","pay","uni","showLoading","title","submitData","orderType","clientType","paymentMethod","paymentClient","initiatePay","then","res","response","result","hideLoading","requestPayment","provider","appid","timeStamp","nonceStr","package","signType","paySign","success","e","showToast","icon","sendMessage","price","fail","exception","showModal","content","showCancel","redirectTo","getWeChatMpMessage","message","templateid","map","item","code","requestSubscribeMessage","tmplIds","complete"],"mappings":"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","file":"pages/order/common/vendor.js","sourcesContent":["/**\n * 申请售后相关API\n */\n\nimport { http, Method } from \"@/utils/request.js\";\n\n/**\n * 获取售后列表\n * @param params\n * @returns {AxiosPromise}\n */\nexport function getAfterSale(params) {\n  return http.request({\n    url: \"after-sales/refunds\",\n    method: Method.GET,\n    needToken: true,\n    loading: false,\n    params,\n  });\n}\n\n\n/******************* 以下为新方法 ***********************/\n/**\n * 申请取消订单\n * @param params\n */\nexport function applyCancelOrder(params) {\n  return http.request({\n    url: \"after-sales/apply/cancel/order\",\n    method: Method.POST,\n    needToken: true,\n    params,\n  });\n}\n\n/**\n/**\n * 获取商家售后收件地址\n */\nexport function getStoreAfterSaleAddress(sn) {\n  return http.request({\n    url: `/order/afterSale/getStoreAfterSaleAddress/${sn}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n/**\n * 取消售后\n */\nexport function cancelAfterSale(afterSaleSn) {\n  return http.request({\n    url: `/order/afterSale/cancel/${afterSaleSn}`,\n    method: Method.POST,\n    needToken: true,\n  });\n}\n\n\n\n/**\n * 获取售后服务记录相关数据\n * @param params 参数\n */\nexport function getAfterSaleList(params) {\n  return http.request({\n    url: `/order/afterSale/page`,\n    method: Method.GET,\n    needToken: true,\n    params,\n  });\n}\n\n/**\n * 查看售后服务详情\n * @param sn 售后服务单编号\n */\nexport function getServiceDetail(sn) {\n  return http.request({\n    url: `/order/afterSale/get/${sn}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n\n/**\n * 添加投诉\n */\nexport function addComplain(params) {\n  return http.request({\n    url: `/order/complain`,\n    method: Method.POST,\n    needToken: true,\n    header: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    data: params,\n  });\n}\n\n/**\n * 取消投诉\n */\nexport function clearComplain(id, params) {\n  return http.request({\n    url: `/order/complain/status/${id}`,\n    method: Method.PUT,\n    needToken: true,\n    params,\n  });\n}\n\n/**\n * 取消投诉\n */\nexport function getAfterSaleLog(sn) {\n  return http.request({\n    url: `/order/afterSale/get/getAfterSaleLog/${sn}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n/**\n * 投诉列表\n */\nexport function getComplain(params) {\n  return http.request({\n    url: `/order/complain`,\n    method: Method.GET,\n    needToken: true,\n    params,\n  });\n}\n\n/**\n * 获取申请原因\n */\nexport function getAfterSaleReason(serviceType) {\n  return http.request({\n    url: `/order/afterSale/get/afterSaleReason/${serviceType}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n/**\n * 获取取消原因\n */\nexport function getClearReason() {\n  return http.request({\n    url: `/order/afterSale/get/afterSaleReason/CANCEL`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n/**\n * 获取投诉原因\n */\nexport function getComplainReason() {\n  return http.request({\n    url: `/order/afterSale/get/afterSaleReason/COMPLAIN`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n/**\n * 获取投诉详情\n */\nexport function getComplainDetail(id) {\n  return http.request({\n    url: `/order/complain/${id}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n/**\n * 获取申请售后页面信息\n */\nexport function getAfterSaleInfo(sn) {\n  return http.request({\n    url: `/order/afterSale/applyAfterSaleInfo/${sn}`,\n    method: Method.GET,\n    needToken: true,\n  });\n}\n\n/**\n * 申请退货服务\n * @param params\n */\nexport function applyReturn(orderItemSn, params) {\n  return http.request({\n    url: `/order/afterSale/save/${orderItemSn}`,\n    method: Method.POST,\n    header: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    data: params,\n  });\n}\n\n/**\n * 填充物流信息\n * @param afterSaleSn 售后服务单号\n * @param params 参数信息\n */\nexport function fillShipInfo(afterSaleSn, params) {\n  return http.request({\n    url: `/order/afterSale/delivery/${afterSaleSn}`,\n    method: Method.POST,\n    header: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    data: params,\n  });\n}\n\n// 添加交易投诉对话\nexport function communication(params) {\n  return http.request({\n    url: `/order/complain/communication`,\n    method: Method.POST,\n    needToken: true,\n    params\n  });\n}","/**\n * 微信小程序支付\n * 此处针对于微信小程序开发的支付插件\n * 第一次支付成功后会跳出订阅的消息 如果用户拒绝或同意都会跳转到支付成功页面\n * 如果点击订阅 会将状态写进缓存 之后不再提醒。\n * \n * @param {sn,price}\n */\n\nimport { getWeChatMpMessage } from \"@/api/message.js\";\nimport { initiatePay } from \"@/api/trade\";\nclass LiLiWXPay {\n  constructor(...payList) {\n    this.data = payList[0];\n    console.log(payList);\n    // 调用支付\n    this.pay = () => {\n      uni.showLoading({\n        title: \"加载中\",\n      });\n\n      let submitData = {\n        sn: this.data.sn,\n        orderType: this.data.orderType || \"TRADE\",\n        clientType: \"WECHAT_MP\",\n      };\n      const paymentMethod = \"WECHAT\";\n      const paymentClient = \"MP\";\n      // 调用支付\n      initiatePay(paymentMethod, paymentClient, submitData).then((res) => {\n        let response = res.data.result;\n        uni.hideLoading();\n        uni.requestPayment({\n          provider: \"wxpay\",\n          appid: response.appid,\n          timeStamp: response.timeStamp,\n          nonceStr: response.nonceStr,\n          package: response.package,\n          signType: response.signType,\n          paySign: response.paySign,\n          success: (e) => {\n            uni.showToast({\n              icon: \"none\",\n              title: \"支付成功!\",\n            });\n            sendMessage(payList[0].price);\n          },\n          fail: (e) => {\n            this.exception = e;\n            // 支付异常或支付失败之后跳转到订单页面\n            uni.showModal({\n              content: \"支付失败,如果您已支付，请勿反复支付\",\n              showCancel: false,\n              success: () => {\n                uni.redirectTo({\n                  url: \"/pages/order/myOrder?status=0\",\n                });\n              },\n            });\n          },\n        });\n      });\n    };\n  }\n}\n\nfunction sendMessage(price) {\n\n\n  //订阅消息\n  getWeChatMpMessage().then((res) => {\n    var message = res.data.result;\n    var templateid = message.map((item) => item.code);\n    uni.requestSubscribeMessage({\n      tmplIds: templateid,\n      success: (res) => {\n      \n      },\n      fail: (res) => {\n        console.log('fail', res)\n        uni.showToast({\n          icon: \"none\",\n          title: \"订阅消息失败\",\n        })\n      },\n      complete: (res) => {\n        console.log('complete', res)\n\n        /**\n         * 已经支付成功\n         */\n        uni.redirectTo({\n          url:\n            \"/pages/cart/payment/success?paymentMethod=WECHAT\" +\n            \"&payPrice=\" +\n            price,\n        });\n      },\n    });\n  });\n\n}\n\nexport default LiLiWXPay;\n"],"sourceRoot":""}