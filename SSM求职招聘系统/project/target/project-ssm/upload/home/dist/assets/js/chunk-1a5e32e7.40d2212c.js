(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a5e32e7"],{"14f9":function(r,e,t){},4619:function(r,e,t){},"5dc0":function(r,e,t){"use strict";t.r(e);var s=function(){var r=this,e=r._self._c;return e("div",{staticClass:"page_account register",attrs:{id:"account_register"}},[e("div",{staticClass:"warp register_warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row row_registers"},[r._m(0),e("div",{staticClass:"form_register"},[e("div",{staticClass:"form_box"},[e("b-form",{staticClass:"forms"},[e("div",{staticClass:"diy_forms"},[e("b-form-group",{attrs:{id:"input-group-1",label:"账号:","label-for":"input-1"}},[e("b-form-input",{attrs:{id:"input-1",type:"text",placeholder:"账号",trim:""},model:{value:r.form.username,callback:function(e){r.$set(r.form,"username",e)},expression:"form.username"}})],1),e("b-form-group",{attrs:{id:"input-group-2",label:"设置密码:","label-for":"input-2"}},[e("b-form-input",{attrs:{id:"input-2",type:"password",placeholder:"5个字符到16个字符",trim:""},model:{value:r.form.password,callback:function(e){r.$set(r.form,"password",e)},expression:"form.password"}})],1),e("b-form-group",{attrs:{id:"input-group-3",label:"确认密码:","label-for":"input-3"}},[e("b-form-input",{attrs:{id:"input-3",type:"password",placeholder:"确认密码",trim:""},model:{value:r.confirm_password,callback:function(e){r.confirm_password=e},expression:"confirm_password"}})],1),e("b-form-group",{attrs:{id:"input-group-4",label:"昵称:","label-for":"input-4"}},[e("b-form-input",{attrs:{id:"input-4",type:"text",placeholder:"2个字符到12个字符",trim:""},model:{value:r.form.nickname,callback:function(e){r.$set(r.form,"nickname",e)},expression:"form.nickname"}})],1),e("b-form-group",{attrs:{id:"input-group-5",label:"邮箱:","label-for":"input-5"}},[e("b-form-input",{attrs:{id:"input-5",type:"email",placeholder:"例: example@123.com",trim:""},model:{value:r.form.email,callback:function(e){r.$set(r.form,"email",e)},expression:"form.email"}})],1),e("b-form-group",{attrs:{id:"input-group-7",label:"身份:","label-for":"input-7"}},[e("b-form-select",{attrs:{id:"user_group",options:r.list_user_group,placeholder:"请选择身份"},model:{value:r.form.user_group,callback:function(e){r.$set(r.form,"user_group",e)},expression:"form.user_group"}})],1)],1),"普通用户"===r.form.user_group?e("form_regular_users",{attrs:{form:r.form_sub}}):r._e()],1),e("div",{staticClass:"btns_bottom rs_bt"},[e("button",{staticClass:"btn_item btn",on:{click:function(e){return r.submit()}}},[e("span",[r._v("注册")])]),e("button",{staticClass:"forgot_nav btn",on:{click:function(e){return r.$router.push("/account/forgot")}}},[e("span",[r._v("找回密码")])]),e("button",{staticClass:"login_bt btn",on:{click:function(e){return r.$router.push("/account/login")}}},[r._v("是否已经拥有一个账户?"),e("span",[r._v("去登录")])])])],1)]),r._m(1)])])])])},o=[function(){var r=this,e=r._self._c;return e("div",{staticClass:"t-box"},[e("span"),e("span")])},function(){var r=this,e=r._self._c;return e("div",{staticClass:"b-box"},[e("span"),e("span")])}],i=t("c6e7"),a=function(){var r=this,e=r._self._c;return e("div",{staticClass:"diy_form"},[r.$check_register_field("add","user_name","/regular_users/view")?e("b-form-group",{attrs:{id:"input-group-${idx}",label:"用户姓名","label-for":"input-${idx}"}},[e("b-form-input",{attrs:{id:"input-${idx}",type:"text",placeholder:"用户姓名",trim:""},model:{value:r.form["user_name"],callback:function(e){r.$set(r.form,"user_name",e)},expression:"form['user_name']"}})],1):r._e(),r.$check_register_field("add","user_gender","/regular_users/view")?e("b-form-group",{attrs:{id:"input-group-${idx}",label:"用户性别","label-for":"input-${idx}"}},[e("b-form-select",{attrs:{id:"input-${idx}",options:r.getDropList(r.list_user_gender)},model:{value:r.form["user_gender"],callback:function(e){r.$set(r.form,"user_gender",e)},expression:"form['user_gender']"}})],1):r._e(),r.$check_register_field("add","contact_information","/regular_users/view")?e("b-form-group",{attrs:{id:"input-group-${idx}",label:"联系方式","label-for":"input-${idx}"}},[e("b-form-input",{attrs:{id:"input-${idx}",type:"tel",placeholder:"联系方式",trim:""},model:{value:r.form["contact_information"],callback:function(e){r.$set(r.form,"contact_information",e)},expression:"form['contact_information']"}})],1):r._e()],1)},u=[],n=t("6265"),l={mixins:[n["a"]],model:{prop:"form",event:"change"},props:{form:{type:Object,default:()=>({})}},data(){return{url_upload:"~/api/regular_users/upload?",list_user_gender:"男,女"}},methods:{getDropList(r){let e=[];if(r){let t=r.split(",");t.forEach(r=>{e.push({value:r,text:r})})}return e},uploadFile(r,e="img"){var t=this,s=new FormData;s.append("file",r[0]),this.$upload(this.url_upload,s,(function(r){r.result?(t.$delete(t.form,e),t.$set(t.form,e,r.result.url),console.log(t.form[e])):t.$toast("上传失败！")}))}},created(){},mounted(){}},c=l,m=(t("fddc"),t("0b56")),p=Object(m["a"])(c,a,u,!1,null,null,null),f=p.exports,_={components:{form_regular_users:f},mixins:[i["a"]],data(){return{url_submit:"~/api/user/register?",form:{username:"",password:"",nickname:"",email:"",user_group:""},confirm_password:"",form_sub:{},list_user_group:[],user_group:[]}},methods:{get_list_user_group(){this.$get("~/api/user_group/get_list?register_max=3&register_min=2",{},r=>{if(r.result.list){var e=[],t=r.result.list;t.map(r=>{e.push({value:r.name,text:r.name})}),this.list_user_group=e,this.user_group=t}else r.error&&(console.error(r.error),this.$toast(r.error.message,"error"))})},async submit(r,e){r||(r=this.form);var t,s=this.events("submit_before",Object.assign({},r))||r,o=await this.events("submit_check",s);return console.log("提交前错误信息msg：",o),o?this.$toast(o,"danger"):t=this.events("submit_main",s,e),t},submit_before(r){r.user_group},async submit_check(r){var e=null,t=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,{username:s,password:o,nickname:i,user_group:a,email:u}=r,n=this.confirm_password;if(console.log("表单校验username ,password ,email ,nickname ,user_group",s,o,u,i,a),s?s.length>16||s.length<5?e="账号长度应为5到16个字符之间！":o?o.length>16||o.length<5?e="密码长度应为5到16个字符之间！":i&&i.length>12||i.length<2?e="昵称长度应为2个字符到12个字符之间":u&&!t.test(u)?e="请输入正确的邮箱地址 例：test@test.com!":o!=n?e="确认密码与密码不一致！":a||(e="请选择用户组!"):e="密码不能为空!":e="账号不能为空",!e&&a&&"普通用户"===a){var l=Object.assign({},this.form_sub);let r=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;if(l.contact_information&&!r.test(l.contact_information))return"手机号格式错误"}var c={username:r.username};if(!e){var m=await this.$get("~/api/user/count?",c);m.result&&(e="用户已存在!")}return e},submit_after(r,e){var t=Object.assign({},this.form);delete t.password,console.log("查询表单form",t);var s=this.user_group.getVal("source_table",{name:t.user_group});console.log("关联表:",s),s?this.get_submit(t,s):console.log("用户组没有关联表")},get_submit(r,e){var t=this.form_sub;this.$get("~/api/user/get_obj?",r,r=>{console.log("注册表信息res",r),r.result&&r.result.obj?(t.user_id=r.result.obj.user_id,this.submit_sub(t,e)):r.error&&(console.error(r.error),this.$toast(r.error.message,"error"))})},submit_sub(r,e){this.$post("~/api/"+e+"/add?",r,r=>{console.log("提交结果res：",r),r.result?(this.$toast("注册成功!"),this.$router.push("/")):r.error&&(console.error(r.error),this.$toast(r.error.message))})}},created(){this.get_list_user_group()}},d=_,g=(t("9b8c"),Object(m["a"])(d,s,o,!1,null,"ead01656",null));e["default"]=g.exports},"9b8c":function(r,e,t){"use strict";t("4619")},fddc:function(r,e,t){"use strict";t("14f9")}}]);